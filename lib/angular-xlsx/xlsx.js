angular.module("ngXlsx",[]).factory("ngXlsx",["$interpolate",function(a){function b(){return this instanceof b?(this.SheetNames=[],void(this.Sheets={})):new b}function c(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5}function d(a,b,d){for(var e=0;e<b.length;e++){e>d.e.c&&(d.e.c=e);var f={v:b[e]};if(null!==f.v){"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Function?f.v(f,{datenum:c}):f.v instanceof Date?(f.t="n",f.z=XLSX.SSF._table[14],f.v=c(f.v)):f.t="s";var g=XLSX.utils.encode_cell({c:e,r:d.e.r});a[g]=f}}d.e.r++}function e(c){var e={bookType:"xlsx",bookSST:!1,type:"binary"},f=new b,g=a.startSymbol(),h=a.endSymbol();c.forEach(function(b){var c={},e=b.columnDefs,i={s:{c:0,r:0},e:{c:e.length-1,r:0}},j=[];e.forEach(function(b){j.push(b.displayName),b.interpolator=a(b.cellFilter?g+b.field+"|"+b.cellFilter+h:g+b.field+h)}),d(c,j,i),b.data.forEach(function(a){var b=[];e.forEach(function(c){var d=c.interpolator(a);b.push(d)}),d(c,b,i)}),i.e.r--,c["!ref"]=XLSX.utils.encode_range(i),f.SheetNames.push(b.sheetName),f.Sheets[b.sheetName]=c});var i=XLSX.write(f,e);return i}function f(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}function g(a){var b=e(a);return new Blob([f(b)],{type:"application/octet-stream"})}return{writeXlsx:e,getBlob:g}}]);